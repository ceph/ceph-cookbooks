[global]
<% unless node['ceph']['config']['fsid'].nil? -%>
  fsid = <%= node['ceph']['config']['fsid'] %>
<% end -%>
<% if node['ceph']['is_mon'] -%>
  mon initial members = <%= node['ceph']['config']['mon_initial_members'] %>
<% end -%>
  mon host = <%= @mon_addresses.sort.join(', ') %>
<% if (! node['ceph']['config']['global'].nil?) -%>
  <% node['ceph']['config']['global'].sort.each do |k, v| %>
  <%= k %> = <%= v %>
  <% end %>
<% end -%>

<% if (! node['ceph']['config']['osd'].nil?) -%>
[osd]
  <% node['ceph']['config']['osd'].sort.each do |k, v| %>
  <%= k %> = <%= v %>
  <% end %>
<% end -%>

<% if (! node['ceph']['config']['mon'].nil?) -%>
[mon]
  <% node['ceph']['config']['mon'].sort.each do |k, v| %>
  <%= k %> = <%= v %>
  <% end %>
<% end -%>

<% if (! node['ceph']['config']['mds'].nil?) -%>
[mds]
  <% node['ceph']['config']['mds'].sort.each do |key, value| -%>
  <%= key %> = <%= value %>
  <%   end -%>
<% end -%>

<% if (@is_rgw) -%>
[client.radosgw.<%= node['hostname'] %>]
  host = <%= node['hostname'] %>
  rgw socket path = /var/run/ceph-radosgw/radosgw.<%= node['hostname'] %>
  admin socket = /var/run/ceph-radosgw/ceph-client.radosgw.<%= node['hostname'] %>.asok
  pid file = /var/run/ceph-radosgw/$name.pid
  keyring = /etc/ceph/ceph.client.radosgw.<%= node['hostname'] %>.keyring
  log file = /var/log/radosgw/radosgw.log
<% if (! node['ceph']['config']['rgw'].nil?) -%>
  <% node['ceph']['config']['rgw'].sort.each do |k, v| %>
  <%= k %> = <%= v %>
  <% end %>
<% end -%>

<% node['ceph']['radosgw']['instances'].sort.each do |name, instance| -%>
[<%= name %>]
  host = <%= node['hostname'] %>
  log file = /var/log/ceph/radosgw-<%= instance['rgw zone'] %>.log
<%- instance.sort.reject{ |k,v| (! k.is_a? String) || (! v.is_a? String) }.each do |k,v| %>
  <%= k %> = <%= v %>
<%- end %>
<%- end # radosgw.instances.each -%>
<% end # if is_rgw -%>

<% node['ceph']['config-sections'].sort.each do |name, sect| %>
[<%= name %>]
  <% sect.sort.each do |k, v| %>
  <%= k %> = <%= v %>
  <% end %>
<% end %>
